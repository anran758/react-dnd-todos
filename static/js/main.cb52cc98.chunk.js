(this["webpackJsonpreact-dnd-todos"]=this["webpackJsonpreact-dnd-todos"]||[]).push([[0],{42:function(t,e,n){"use strict";n.r(e);var c=n(2),o=n(19),i=n(44),a=n(23),r=n(4),s=n(1),d=n(17),u=n.n(d),l=n(11),f=["001 - 03708 - \u4e2d\u56fd\u8fd1\u73b0\u4ee3\u53f2\u7eb2\u8981","002 - 03709 - \u9a6c\u514b\u601d\u4e3b\u4e49\u57fa\u672c\u539f\u7406\u6982\u8bba","005 - 02197 - \u6982\u7387\u8bba\u4e0e\u6570\u7406\u7edf\u8ba1(\u4e8c)","006 - 02324 - \u79bb\u6563\u6570\u5b66","007 - 02331 - \u6570\u636e\u7ed3\u6784","008 - 04735 - \u6570\u636e\u5e93\u7cfb\u7edf\u539f\u7406","009 - 02325 - \u8ba1\u7b97\u673a\u7cfb\u7edf\u7ed3\u6784","010 - 02326 - \u64cd\u4f5c\u7cfb\u7edf","011 - 04737 - C++\u7a0b\u5e8f\u8bbe\u8ba1","012 - 04747 - Java\u8bed\u8a00\u7a0b\u5e8f\u8bbe\u8ba1(\u4e00)","013 - 02333 - \u8f6f\u4ef6\u5de5\u7a0b","014 - 04741 - \u8ba1\u7b97\u673a\u7f51\u7edc\u539f\u7406","015 - 11441 - \u8ba1\u7b97\u673a\u53ca\u5e94\u7528\u8bfe\u7a0b\u5b9e\u9a8c(\u4e8c)","016 - 10203 - \u8ba1\u7b97\u673a\u53ca\u5e94\u7528\u6bd5\u4e1a\u8bbe\u8ba1","003 - 00015 - \u82f1\u8bed(\u4e8c)","004 - 00023 - \u9ad8\u7b49\u6570\u5b66(\u5de5\u672c)"];var j=n(45),p=n(46),m=n(20),b=n.n(m),O="card",g=n(5),v=n.n(g),x=Object(s.memo)((function(t){var e=t.id,n=t.text,o=t.complate,i=t.active,a=t.onMove,d=t.onActive,u=t.onClose,l=t.onCompolate,f=Object(s.useRef)(null),m=Object(j.a)({item:{id:e,type:O},collect:function(t){return{isDragging:t.isDragging()}}}),g=Object(r.a)(m,2),x=g[0].isDragging,h=g[1],I=Object(p.a)({accept:O,hover(t){var n=t.id;n!==e&&a(n,e)}}),_=Object(r.a)(I,2)[1];return h(f),_(f),Object(c.jsxs)("div",{ref:f,className:b()(v.a.item,{[v.a.light]:i,[v.a.complate]:o}),style:{opacity:x?0:1},children:[Object(c.jsx)("span",{className:v.a.itemText,children:n}),Object(c.jsxs)("div",{className:v.a.itemActions,children:[Object(c.jsx)("span",{className:v.a.button,onClick:function(){return d(e)},children:i?"\u53d6\u6d88\u9ad8\u4eae":"\u9ad8\u4eae"}),Object(c.jsx)("span",{className:v.a.button,onClick:function(){return l(e)},children:o?"\u53d6\u6d88\u5b8c\u6210":"\u5b8c\u6210"}),Object(c.jsx)("span",{className:v.a.button,onClick:function(){return u(e)},children:"\u5220\u9664"})]})]})}));x.displayName="TodoItem";var h=x,I=function(){var t={},e=[];return f.forEach((function(n,c,o){var i=Object(l.generate)(),a={id:i,text:n,complate:!1,active:!1,createdDate:Date.now()};c<2?a.active=!0:c>=o.length-2&&(a.complate=!0),t[i]=a,e.push(i)})),{dataByIds:e,dataByMapping:t}}(),_=I.dataByIds,y=I.dataByMapping,S="TODO_STORE_LIST",T="TODO_STORE_MAPPING",N={width:600,margin:"auto"},D=Object(s.memo)((function(){var t=Object(s.useState)({}),e=Object(r.a)(t,2),n=e[0],o=e[1],i=Object(s.useState)([]),a=Object(r.a)(i,2),d=a[0],f=a[1],j=Object(s.useState)(""),p=Object(r.a)(j,2),m=p[0],b=p[1],O=Object(s.useRef)(),g=Object(s.useRef)(),v=function(t){O.current=t,g.current||(g.current=requestAnimationFrame((function(){var t=O.current;if(t){if(t.todosMapping){var e=u()(n,t.todosMapping);o(e)}if(t.todosIds){var c=u()(d,t.todosIds);f(c)}O.current=void 0,g.current=void 0,console.log("================== drawFrame end ==================")}})))},x=function(){if(m){var t={id:Object(l.generate)(),text:m,complate:!1,active:!1,createdDate:Date.now()};v({todosIds:{$unshift:[t.id]},todosMapping:{[t.id]:{$set:t}}}),b("")}},I=function(t,e){var n=d.findIndex((function(e){return e===t})),c=d.findIndex((function(t){return t===e}));v({todosIds:{$splice:[[n,1],[c,0,t]]}})},D=function(t){v({todosMapping:{[t]:{$toggle:["active"]}}})},A=function(t){var e=n[t];if(console.log("data",e),e){var c={todosMapping:{[t]:{$toggle:["complate"],active:{$set:!1}}}},o=d.findIndex((function(e){return e===t}));if(e.complate){var i=d.findIndex((function(t){return!n[t].active}));-1===i&&(i=0),c.todosIds={$splice:[[o,1],[i,0,t]]}}else c.todosIds={$splice:[[o,1]],$push:[t]};v(c)}},M=function(t){if(window.confirm("confrim remove this todo?")){var e=d.findIndex((function(e){return e===t}));v({todosIds:{$splice:[[e,1]]},todosMapping:{$unset:[t]}})}};return Object(s.useEffect)((function(){var t=JSON.parse(localStorage.getItem(T))||y,e=JSON.parse(localStorage.getItem(S))||_;return o(t),f(e),function(){return g&&cancelAnimationFrame(g)}}),[]),Object(s.useEffect)((function(){return localStorage.setItem(S,JSON.stringify(d))}),[d]),Object(s.useEffect)((function(){localStorage.setItem(T,JSON.stringify(n))}),[n]),Object(c.jsxs)("section",{children:[Object(c.jsx)("h2",{style:{textAlign:"center"},children:"React DnD todos"}),Object(c.jsxs)("section",{style:{marginBottom:12,textAlign:"center"},children:[Object(c.jsx)("input",{type:"text",value:m,placeholder:"input something todo...",style:{marginRight:8},onInput:function(t){return b(t.target.value)},onKeyDown:function(t){"Enter"===t.key&&x()}}),Object(c.jsx)("button",{onClick:x,children:"Submit"})]}),Object(c.jsx)("section",{style:N,children:d.map((function(t){var e=n[t];return e?Object(c.jsx)(h,{id:e.id,text:e.text,active:e.active,complate:e.complate,onMove:I,onActive:D,onCompolate:A,onClose:M},e.id):null}))})]})}));function A(){var t=Object(s.useState)(!1),e=Object(r.a)(t,2),n=e[0],o=e[1];return Object(s.useEffect)((function(){return o(!0)}),[]),Object(c.jsx)(c.Fragment,{children:n&&Object(c.jsx)(D,{})})}function M(){return Object(c.jsx)("div",{className:"App",children:Object(c.jsx)(i.a,{backend:a.a,children:Object(c.jsx)(A,{})})})}Object(o.render)(Object(c.jsx)(M,{}),document.getElementById("root"))},5:function(t,e,n){t.exports={item:"Todos_item__XcDJN",light:"Todos_light__3aCHq",itemText:"Todos_itemText__3vSUJ",complate:"Todos_complate__1gxGn",itemActions:"Todos_itemActions__3uP3u",button:"Todos_button__24xIk"}}},[[42,1,2]]]);
//# sourceMappingURL=main.cb52cc98.chunk.js.map