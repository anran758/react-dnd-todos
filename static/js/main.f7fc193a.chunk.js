(this["webpackJsonpreact-dnd-todos"]=this["webpackJsonpreact-dnd-todos"]||[]).push([[0],{42:function(t,e,n){"use strict";n.r(e);var o=n(2),c=n(18),i=n(44),a=n(23),s=n(4),r=n(1),u=n(16),d=n.n(u),l=n(19),j=n(45),m=n(46),f=n(20),b=n.n(f),p="card",O=n(5),g=n.n(O),x=Object(r.memo)((function(t){var e=t.id,n=t.text,c=t.complate,i=t.active,a=t.onMove,u=t.onActive,d=t.onClose,l=t.onCompolate,f=Object(r.useRef)(null),O=Object(j.a)({item:{id:e,type:p},collect:function(t){return{isDragging:t.isDragging()}}}),x=Object(s.a)(O,2),v=x[0].isDragging,h=x[1],_=Object(m.a)({accept:p,hover(t){var n=t.id;n!==e&&a(n,e)}}),I=Object(s.a)(_,2)[1];return h(f),I(f),Object(o.jsxs)("div",{ref:f,className:b()(g.a.item,{[g.a.light]:i,[g.a.complate]:c}),style:{opacity:v?0:1},children:[Object(o.jsx)("span",{className:g.a.itemText,children:n}),Object(o.jsxs)("div",{className:g.a.itemActions,children:[Object(o.jsx)("span",{className:g.a.button,onClick:function(){return u(e)},children:i?"\u53d6\u6d88\u9ad8\u4eae":"\u9ad8\u4eae"}),Object(o.jsx)("span",{className:g.a.button,onClick:function(){return l(e)},children:c?"\u53d6\u6d88\u5b8c\u6210":"\u5b8c\u6210"}),Object(o.jsx)("span",{className:g.a.button,onClick:function(){return d(e)},children:"\u5220\u9664"})]})]})}));x.displayName="TodoItem";var v=x,h="TODO_STORE_LIST",_="TODO_STORE_MAPPING",I={width:600,margin:"auto"},S=Object(r.memo)((function(){var t=Object(r.useState)({}),e=Object(s.a)(t,2),n=e[0],c=e[1],i=Object(r.useState)([]),a=Object(s.a)(i,2),u=a[0],j=a[1],m=Object(r.useState)(""),f=Object(s.a)(m,2),b=f[0],p=f[1],O=Object(r.useRef)(),g=Object(r.useRef)(),x=function(t){O.current=t,g.current||(g.current=requestAnimationFrame((function(){var t=O.current;if(console.log("drawFrame --\x3e ",t),t){if(t.todosMapping){var e=d()(n,t.todosMapping);c(e)}if(t.todosIds){var o=d()(u,t.todosIds);j(o)}O.current=void 0,g.current=void 0,console.log("================== drawFrame end ==================")}})))},S=function(){if(b){var t={id:Object(l.generate)(),text:b,complate:!1,active:!1,createdDate:Date.now()};x({todosIds:{$unshift:[t.id]},todosMapping:{[t.id]:{$set:t}}}),p("")}},T=function(t,e){var n=u.findIndex((function(e){return e===t})),o=u.findIndex((function(t){return t===e}));x({todosIds:{$splice:[[n,1],[o,0,t]]}})},y=function(t){x({todosMapping:{[t]:{$toggle:["active"]}}})},N=function(t){var e=u.findIndex((function(e){return e===t}));x({todosIds:{$splice:[[e,1]],$push:[t]},todosMapping:{[t]:{$toggle:["complate"],active:{$set:!1}}}})},A=function(t){if(window.confirm("confrim remove this todo?")){var e=u.findIndex((function(e){return e===t}));x({todosIds:{$splice:[[e,1]]},todosMapping:{$unset:[t]}})}};return Object(r.useEffect)((function(){var t=JSON.parse(localStorage.getItem(_))||{},e=JSON.parse(localStorage.getItem(h))||[];return c(t),j(e),function(){return g&&cancelAnimationFrame(g)}}),[]),Object(r.useEffect)((function(){return localStorage.setItem(h,JSON.stringify(u))}),[u]),Object(r.useEffect)((function(){localStorage.setItem(_,JSON.stringify(n))}),[n]),console.log("todosIds and todosMapping",u,n),Object(o.jsxs)("section",{children:[Object(o.jsx)("h2",{style:{textAlign:"center"},children:"React DnD todos"}),Object(o.jsxs)("section",{style:{marginBottom:12,textAlign:"center"},children:[Object(o.jsx)("input",{type:"text",value:b,placeholder:"input something todo...",style:{marginRight:8},onInput:function(t){return p(t.target.value)},onKeyDown:function(t){"Enter"===t.key&&(S(),p(""))}}),Object(o.jsx)("button",{onClick:S,children:"Submit"})]}),Object(o.jsx)("section",{style:I,children:u.map((function(t){var e=n[t];return e?Object(o.jsx)(v,{id:e.id,text:e.text,active:e.active,complate:e.complate,onMove:T,onActive:y,onCompolate:N,onClose:A},e.id):null}))})]})}));function T(){var t=Object(r.useState)(!1),e=Object(s.a)(t,2),n=e[0],c=e[1];return Object(r.useEffect)((function(){return c(!0)}),[]),Object(o.jsx)(o.Fragment,{children:n&&Object(o.jsx)(S,{})})}function y(){return Object(o.jsx)("div",{className:"App",children:Object(o.jsx)(i.a,{backend:a.a,children:Object(o.jsx)(T,{})})})}Object(c.render)(Object(o.jsx)(y,{}),document.getElementById("root"))},5:function(t,e,n){t.exports={item:"Todos_item__XcDJN",light:"Todos_light__3aCHq",itemText:"Todos_itemText__3vSUJ",complate:"Todos_complate__1gxGn",itemActions:"Todos_itemActions__3uP3u",button:"Todos_button__24xIk"}}},[[42,1,2]]]);
//# sourceMappingURL=main.f7fc193a.chunk.js.map